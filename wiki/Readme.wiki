#summary はじめにお読みください
#labels Featured

= !MacVim-!KaoriYa =

<wiki:toc max_depth="2" /> 

== インストール先 ==

アプリケーションフォルダ以外の場所に置いても動作するようになっています。


== アンインストール ==

  * アプリケーションフォルダの!MacVimアイコン
  * ホームフォルダ/ライブラリ/Preferences/org.vim.!MacVim.!KaoriYa.plist
を削除します。


== vimrc/gvimrc ==

  # !MacVim.app/Contents/Resources/vim/vimrc
  # ホームフォルダ/.vimrc または `_`vimrc
  # !MacVim.app/Contents/Resources/vim/gvimrc
  # ホームフォルダ/.gvimrc または `_`gvimrc

の順番で読み込まれます。読み込まれたスクリプトは

 [http://www.ac.cyberhome.ne.jp/~yakahaira/vimdoc/repeat.html#:scriptnames :scriptnames]

にて確認できます。

!MacVim(含!MacVim-!KaoriYa)かどうかを判別するには

{{{
has('gui_macvim')
}}}

を使用します。

!MacVim-!KaoriYaかどうかを判別するには、上記に加えて、

{{{
has('kaoriya')
}}}

を使用します。

{{{
has('gui_running')
}}}

で、GUI動作中(!MacVim.app実行中)かどうか判別できます。


== migemo検索 ==

{{{
g/ 順方向migemo検索
g? 逆方向migemo検索
}}}

== ツールバー ==

ツールバーを非表示にしたい場合は
{{{
set guioptions-=T
}}}

ツールバーを表示したい場合は
{{{
set guioptions+=T
}}}


== 半透明 ==

ウインドウを半透明にしたい場合は
{{{
set transparency=10    (不透明 0〜100 透明)
}}}


== 外部エディタで編集 ==

「環境設定…」の「連携」で「インストール」を押すと、/Library/!InputManagersに外部エディタを呼び出すためのバンドルがインストールされます(SIMBLなどと同じです)。

たとえばSafariでGMailのメール作成時に「編集(またはEdit)」メニューの「Edit in !MacVim…」を選択すれば、!MacVimで編集できます。保存して終了すれば、Safariなどに反映される仕組みです。Mail.appなどでも使用できます。

デフォルトのキーバインドは「シフト＋コントロール＋コマンド＋E」です。

Mail.appでは、「コントロール+A」で全選択したのち「シフト＋コントロール＋コマンド＋E」を押せば、!MacVimでメールを編集できます。


== 言語環境 ==

Finderから!MacVimアイコンの「情報を見る」「言語」で日本語のチェックを外すと、英語環境で起動します。


== 文字コード判別 ==

[http://yukihiro.nakadaira.googlepages.com/#chardet gauche_guess] により、自動的に文字コードの判別を行います。

fileencodings(fencs) は設定不要です。.vimrcなどでfileencodings(fencs)を設定すると文字コード判別が動作しなくなります。


== コンソールからの使用 ==

Terminal.appやiTerm.appから使用する場合は、

 [http://repo.or.cz/w/MacVim/KaoriYa.git?a=blob;f=src/MacVim/mvim;hb=HEAD mvimシェルスクリプト]

などが便利です。もしくは、たとえばzshのエイリアスでも、

{{{
alias vi='env LANG=ja_JP.UTF-8 /Applications/MacVim.app/Contents/MacOS/Vim "$@"'
}}}

などとすると vi ファイル名 で使用できます。デフォルトのvimrcを読み込ませたくない場合は、

{{{
alias vi='env LANG=ja_JP.UTF-8 /Applications/MacVim.app/Contents/MacOS/Vim -u $HOME/.vimrc "$@"'
}}}

とすると良いでしょう。

コンソールから!MacVim.appを使用する場合は、

{{{
alias gvim='env LANG=ja_JP.UTF-8 open -a /Applications/MacVim.app "$@"'
}}}

としておけば、gvim ファイル名 で!MacVim.appで編集できます。


== 香り屋版の情報 ==

Scratchバッファプラグインの動作がおかしいなどの場合は、ホームフォルダ/.vimrcまたは `_`vimrcで、香り屋版のコマンド類を読み込まないように設定します([http://www.serendip.ws/archives/1687 リンク])

{{{
let plugin_cmdex_disable = 1
}}}


== 自動IMオン/オフ無効化 ==

入力モードから抜ける時、入る時などに、自動的に日本語入力(IM)をオン/オフにする機能が入っています(iminsertなどに反映されます)。以下の設定でその機能を無効にすることができます。

{{{
set imdisable
}}}


== +perl / +python / +ruby ==

デフォルトでMac OS X 10.5 (Leopard)の標準パスからperl/python/rubyのdylibを動的に読み込みます。

!MacPortsなどのdylibを使用したい場合は .vimrc にて

{{{
let $PERL_DLL = "/opt/local/lib/perl5/5.8.8/darwin-2level/CORE/libperl.dylib"
let $PYTHON_DLL = "/opt/local/lib/libpython2.5.dylib"
let $RUBY_DLL = "/opt/local/lib/libruby.dylib"
}}}

のように指定します。perl5.8.8, python2.5, ruby1.8.xと互換です。perl5.8.9とは非互換となります。

非互換のものは[Building ソースコードからビルドする]ことで使用できます。python3やruby1.9などは別途パッチが必要となります。vimメーリングリストなどをご参照ください。


== ATSUI ==

メニューバーの「!MacVim」「環境設定…」より「詳細」タブにて

{{{
ATSUIレンダラを使用する
}}}

チェックボックスをONにすると、ATSUIレンダラにより、標準状態より高速に動作します。

 !AppleType Services for Unicode Imaging
 http://developer.apple.com/documentation/Carbon/Conceptual/ATSUI_Concepts/atsui_chap1/atsui_intro.html

IM入力中など多少表示が気になるところもありますが、ほぼ問題なく使用できます。


== 文字間幅 ==

!Terminal.appなどでdefaultsコマンドにて設定できますが、日本語環境では表示が不完全です。

{{{
defaults write org.vim.MacVim.KaoriYa MMCellWidthMultiplier 0.8
}}}


== ウインドウ拡大 ==

「ウインドウ」「拡大」にて横方向も拡大したい場合に設定します。

{{{
defaults write org.vim.MacVim.KaoriYa MMZoomBoth -boolean YES
}}}


== ctags ==

[http://wiki.github.com/splhack/ctags-objc-ja Objective-C 対応 Exuberant Ctags 日本語対応版] を同梱しています。

{{{
!ctags
}}}

などで使用できます。コマンドラインからは

{{{
alias ctags='/Applications/MacVim.app/Contents/MacOS/ctags "$@"'
}}}

などとすると良いでしょう。

[http://www.vim.org/scripts/script.php?script_id=273 taglist.vim] では以下の設定でObjective-Cに対応できます。

{{{
let tlist_objc_settings='objc;P:protocols;i:interfaces;I:implementations;M:instance methods;C:implementation methods;Z:protocol methods'
}}}


== Tiger (Mac OS X 10.4) ==

[http://code.google.com/p/macvim-kaoriya/issues/detail?id=10 対処方法はこちら]